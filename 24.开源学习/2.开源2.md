

### **一、高性能网络库：libhv（C/C++混合）**

#### **项目定位**：跨平台网络库（C实现60% + C++封装30%），支持HTTP/SSL/WebSocket等协议

#### **源码解析资源**：

1. **CSDN博客：libhv源码框架详解**
    
    1. **核心内容**：
        
        - 事件循环（`hloop`）的跨平台实现（epoll/iocp/kqueue）
            
        - 内存池（`hbuf_t`）与环形缓存（`HRingBuf`）的零拷贝设计
            
        - 线程池（`HThreadPool`）的动态扩缩容策略
            
    2. **特色**：对比 Muduo 的 Reactor 模式，解析 libhv 如何通过 C 实现高性能网络库。
        
    3. **学习路径**：GitHub 仓库（[ithewei/libhv](https://github.com/ithewei/libhv)），重点分析 `event/` 和 `evpp/` 目录。
        

  

2. **知乎专栏：libhv 的 C++ 封装哲学**
    
    1. **重点**：
        
        - `HBuf` 对 `hbuf_t` 的面向对象封装
            
        - `HThread` 的线程状态管理（暂停/恢复）
            
        - 异步任务（`Defer`）的 RAII 实现
            
    2. **实践案例**：用 libhv 实现简单的 WebSocket 服务器，对比原生 C 与 C++ 封装的代码量差异。
        

  

#### **架构核心**：

- **分层设计**：`base/`（C基础模块）、`cpputil/`（C++工具）、`protocol/`（协议栈）
    
- **跨平台优化**：统一接口屏蔽 Windows/Linux 差异（如 `hio_t` 对 socket 的抽象）
    
- **性能指标**：单线程支持 10 万 QPS（HTTP 短连接），内存占用比同类库低 30%。
    

  

  

### **二、内存数据库：Redis（纯C）**

#### **项目定位**：内存键值存储（17.5万星，Redis 7.0 中文注释版）

#### **源码解析资源**：

3. **《Redis设计与实现》（黄健宏）**
    
    1. **核心内容**：
        
        - 字典（`dict`）的哈希表 + 链地址法实现
            
        - 持久化（RDB/AOF）的主从同步机制
            
        - 事件驱动（`aeEventLoop`）的多路复用模型
            
    2. **特色**：结合 Redis 7.0 源码，对比旧版本的设计演进。
        
    3. **学习路径**：配套 GitHub 仓库（[CN-Annotation-Team/redis](https://github.com/CN-Annotation-Team/redis)），逐文件分析 `server.c` 和 `dict.c`。
        

  

4. **CSDN博客：Redis 7.0 新特性源码解析**
    
    1. **重点**：
        
        - Modules v2 的动态加载机制（`module.c`）
            
        - Stream 数据类型的链表 + 循环缓冲区设计
            
        - Lua 脚本的 JIT 优化（`jit.c`）
            
    2. **实践案例**：用 Redis 模块开发自定义数据结构（如布隆过滤器）。
        

  

#### **架构核心**：

- **数据结构**：`sds`（简单动态字符串）的预分配策略
    
- **线程模型**：单线程处理 + 后台 I/O 线程（`bio`）
    
- **协议解析**：`readQueryFromClient` 的命令解析状态机。
    

  

  

### **三、轻量级 Web 服务器：Nginx（纯C）**

#### **项目定位**：高并发 Web 服务器（20万星，中文注释版）

#### **源码解析资源**：

5. **《深入理解 Nginx：模块开发与架构解析》（陶辉）**
    
    1. **核心内容**：
        
        - 事件驱动（`ngx_event`）的 epoll 封装
            
        - 内存池（`ngx_pool`）的 slab 分配算法
            
        - HTTP 框架（`ngx_http_core_module`）的请求处理流程
            
    2. **特色**：结合 Nginx 1.9.2 中文注释版（[y123456yz/reading-code-of-nginx-1.9.2](https://github.com/y123456yz/reading-code-of-nginx-1.9.2)），解析模块开发接口。
        
    3. **学习路径**：分析 `src/http/ngx_http_request.c` 的请求生命周期。
        

  

6. **知乎专栏：Nginx 与 Apache 的架构对比**
    
    1. **重点**：
        
        - Nginx 的异步非阻塞 vs Apache 的多进程模型
            
        - `ngx_http_upstream_module` 的负载均衡算法
            
        - `ngx_http_proxy_module` 的反向代理实现
            
    2. **实践案例**：用 Nginx 模块实现简单的 WebSocket 代理。
        

  

#### **架构核心**：

- **模块化设计**：11 个 HTTP 处理阶段（`NGX_HTTP_POST_READ_PHASE` 等）
    
- **缓存机制**：`ngx_http_file_cache` 的磁盘缓存与内存索引
    
- **性能优化**：`sendfile` 零拷贝传输与 `TCP_CORK` 优化。
    

  

  

### **四、音视频处理：FFmpeg（C/C++混合）**

#### **项目定位**：多媒体处理框架（4.7万星，雷神博客解析）

#### **源码解析资源**：

7. **雷神的博客：FFmpeg 源码分析系列**
    
    1. **核心内容**：
        
        - 解复用（`avformat_open_input`）的协议探测流程
            
        - 解码（`avcodec_decode_video2`）的线程池优化
            
        - 滤镜（`avfilter_graph`）的图结构管理
            
    2. **特色**：结合具体命令（如 `ffmpeg -i input.mp4 -vf scale=640:480 output.mp4`）解析代码逻辑。
        
    3. **学习路径**：GitHub 仓库（[FFmpeg/FFmpeg](https://github.com/FFmpeg/FFmpeg)），分析 `libavcodec/` 和 `libavfilter/` 目录。
        

  

8. **CSDN博客：FFmpeg 的 C++ 封装实践**
    
    1. **重点**：
        
        - `FFmpegDemuxer` 类的 C++ 封装（RAII 管理上下文）
            
        - 多线程解码的生产者-消费者模型
            
        - 音视频同步的 PTS 时间戳处理
            
    2. **实践案例**：用 C++ 封装实现视频转码工具。
        

  

#### **架构核心**：

- **组件化设计**：`libavformat`（格式处理）、`libavcodec`（编解码）、`libavutil`（工具库）
    
- **线程模型**：`packet_queue` 的无锁队列与条件变量同步
    
- **协议支持**：`avio` 的统一接口屏蔽 HTTP/RTMP 差异。
    

  

  

### **五、分布式版本控制：Git（纯C）**

#### **项目定位**：分布式 VCS（8.4万星，中文教程）

#### **源码解析资源**：

9. **《Pro Git》（Scott Chacon）**
    
    1. **核心内容**：
        
        - 对象存储（`git object`）的 SHA-1 哈希与松散文件管理
            
        - 索引（`index`）的暂存区机制
            
        - 合并（`git merge`）的三路合并算法
            
    2. **特色**：结合 Git 2.30 源码，解析 `builtin/` 目录下的命令实现。
        
    3. **学习路径**：GitHub 仓库（[git/git](https://github.com/git/git)），分析 `builtin/add.c` 和 `builtin/merge.c`。
        

  

10. **GitHub标星36k+的 Git 中文教程**
    
    1. **重点**：
        
        - `git-rebase` 的交互式变基实现
            
        - `git reset` 的版本回滚机制
            
        - 钩子（`hooks`）的脚本触发流程
            
    2. **实践案例**：用 Git 源码实现自定义的版本控制系统。
        

  

#### **架构核心**：

- **数据模型**：`commit`/`tree`/`blob` 的有向无环图（DAG）
    
- **网络协议**：`git fetch` 的智能协议与哑协议对比
    
- **性能优化**：`packfile` 的增量打包与索引加速。
    

  

  

### **六、轻量级 HTTP 服务器：Lighttpd（纯C）**

#### **项目定位**：高性能 Web 服务器（1.3万星，中文书籍）

#### **源码解析资源**：

11. **《Lighttpd源码分析》（高群凯）**
    
    1. **核心内容**：
        
        - 事件驱动（`event_base`）的 select/poll 实现
            
        - 多进程模型（`lighttpd_fork`）的 master-worker 架构
            
        - 模块加载（`mod_init`）的动态扩展机制
            
    2. **特色**：对比 Nginx 的模块化设计，解析 Lighttpd 的插件系统。
        
    3. **学习路径**：GitHub 仓库（[lighttpd/lighttpd1.4](https://github.com/lighttpd/lighttpd1.4)），分析 `src/` 目录下的核心模块。
        

  

12. **CSDN博客：Lighttpd 的 FastCGI 实现**
    
    1. **重点**：
        
        - `mod_fastcgi` 的进程池管理
            
        - `spawn-fcgi` 的子进程通信
            
        - 负载均衡的加权轮询算法
            
    2. **实践案例**：用 Lighttpd 部署 PHP 应用，对比 Nginx 的性能差异。
        

  

#### **架构核心**：

- **内存管理**：`mmap` 的零拷贝文件传输
    
- **安全机制**：`mod_rewrite` 的 URL 重写与 `mod_auth` 的认证
    
- **性能优化**：`mod_compress` 的 Gzip 压缩与 `mod_expire` 的缓存控制。
    

  

  

### **七、学习方法：如何高效剖析纯C/C++混合项目**

#### **1. 四步拆解法（以 Redis 为例）**

- **第一步：绘制调用链**调试 `redis-server` 启动流程，记录 `main()` → `initServer()` → `aeMain()` 的调用栈。
    
- **第二步：分析数据结构**研究 `dict` 的哈希表冲突处理（链地址法）与 `sds` 的预分配策略。
    
- **第三步：对比设计模式**识别单例模式（`server` 全局变量）、工厂模式（`createObject`）。
    
- **第四步：性能测试验证**用 `redis-benchmark` 压测，对比 `O(N)` 与 `O(1)` 命令的耗时差异。
    

  

#### **2. 必备工具**

- **源码阅读**：VS Code + C/C++ 插件（跳转定义、调用树）
    
- **调试**：GDB + `core` 文件分析（如 Redis 的 `abort` 触发）
    
- **性能分析**：Valgrind + Callgrind 分析 FFmpeg 的编解码耗时。
    

  

  

### **八、总结：从源码到架构的学习清单**

|   |   |   |   |
|---|---|---|---|
|项目|核心设计思想|适合人群|解析深度|
|libhv|C/C++ 混合的跨平台网络库|网络编程进阶者|★★★★☆|
|Redis|内存数据结构与事件驱动|数据库开发者|★★★★★|
|Nginx|异步非阻塞的 Web 架构|服务器开发工程师|★★★★☆|
|FFmpeg|多媒体处理的组件化设计|音视频开发者|★★★★☆|
|Git|分布式版本控制的 DAG 模型|工具链开发者|★★★☆☆|

  

**建议顺序**：先从 Redis 掌握内存数据库设计（2 周），再深入 Nginx 理解事件驱动架构（3 周），最后通过 FFmpeg 学习大型系统的组件化设计（4 周）。每个项目搭配对应书籍/博客，边读源码边写注释，最终形成自己的架构设计知识库。