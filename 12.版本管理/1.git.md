## 1.专有名词

```markdown
trace     追踪
generic   泛型
branch    分支
remote    远程
origin    起源
merge     合并
rebase    变基
```

## 2.命令行基础指令

### 2.1 安装git

```bash
/* ubuntu为例

sudo apt install git

#sudo: 获得root权限
#apt: ubuntu的包管理程序
#install: 安装
#git: 程序名字

*/
```

### 2.2 git操作

#### 2.2.1 git首次安装

```Bash
# 以下是初次安装后需要配置的一些信息 

git config --global user.name "u name"   # 若没有空格，可以不使用""
git config --global user.email uemail #uemail是你的邮箱地址
git config --global credential.helper store # 设置不需要每次上传输入密码

# 配置完成后可以开始使用git
# .gitignore文件，.gitignore内的名字（可以是具体文件名，也可以是通配符）
# 将不会被git识别和上传到仓库，（已上传的不受限制）

# *.x代表所有.x文件，这就是*通配符的作用，**/filea 任意目录下的filea
```

#### 2.2.2 git本地仓库

```Bash
git init # 在本地初始化一个空的仓库
git add a.x # 上传a.x 也可以 git add . 上传当前目录所有内容 此时只是上传文件到暂存区
git status # 查看当前暂存区状态
git commit -m "输入你的提交内容注释"  # 将暂存区文件传到仓库
git log # 查看上传记录 
git log --oneline # 查看简单的记录,log指令下使用q退出。
git diff #比较本地和仓库的差别，也可以比较不同版本的差异

# HEAD 意思是比较HEAD也就是最新版本和上一个版本，~后可以加数字表示从HEAD
# 回退几个版本
git diff HEAD~ 
# 在log可以看到每次提交前面有个版本号 ，这里可以使用版本号查询差异
git diff version_x version_y  
# 从本地和仓库删除名为filename的文件，
git rm filename
# 若是只从仓库删除 加上--cached修饰
git rm --cached filename
```

#### 2.2.3 git远程仓库

- ssh配置：
    1. `cd ~/.ssh`
    2. `ssh-keygen -t rsa -b 4096 -C "你的邮箱"`,生成公钥。
    3. `Enter`后输入文件名，然后输入私钥密码，默认不输入直接`Enter`。
    4. `cat 秘钥.hub`,复制内容并绑定到仓库网站的设置里。
    5. 在`.ssh`文件夹下创建一个`config`文件(无后缀文件),填入配置。如下：
       - ```bash
                #github
		        Host github.com
			        Hostname ssh.github.com
			        Port 22 # 443也可以
			        PreferredAuthentications publickey  
			        IdentitiesOnly yes  
			        IdentityFile ~/.ssh/id_rsa # 根据你的私钥路径修改  
			        TCPKeepAlive yes  
			        ServerAliveInterval 60
         ```

#### 2.2.4 关联本地和远程

1. 本地仓库关联单个仓库:
	1. 无本地仓库直接关联远程仓库：`git clone`,无需`git init`。
	2. 有本地仓库再关联远程仓库：
		1. `git init`，初始化本地仓库。
		2. `git remote add origin [SSH链接1]`,一个本地仓库可以关联多个远程仓库。

	- 注：`remote` 表示远程仓库，`origin` 是远程仓库的默认别名（可自定义）。

2. 本地仓库关联第二个仓库：
	-  再次`git remote add origin [SSH链接2]`,关联第二个仓库`push`，但不关联`pull`操作。
	-  `git remote add newname [SSH链接2]`,关联第二个仓库完整，操作时要选择哪个仓库。

#### 2.2.5 推拉和分支

1. 分支名称统一（可选操作）：`git branch -M main` ，将本地分支名称修改为`main`。
	- 目的是与远程仓库主分支同名，避免后续操作混淆。
	- 若不指定具体分支，`git pull`/`git push` 默认操作对象为 `main` 分支；
	- 若推送的分支在远程不存在，会自动创建该分支。

2. 推拉操作：
	- `git pull origin main`,拉取远程`main`分支的最新代码。
    - `git push origin x1`：将本地分支 x1 推送到远程仓库。

    - `git branch`,查询本地所有分支，显示数量和名称，当前分支前有 `*`标记。
    - `git branch xx`,新建本地`xx`分支。
    - `git switch dev`,切换到本地`dev`分支。
    
3. 分支合并删除：
	1. `git merge xxx`,合并`xxx`分支到当前本地分支。
	2. `git branch -d xxx`,删除已合并的分支 `xxx`。
		- 仅能删除已合并的分支。
	3. `git branch -D xxx`。
		- 强制删除未合并的分支，可能丢失修改。
4. 分支切换:不同分支的文件状态是独立的。
	1. 当不同分支间存在差异，如`main`分支删除了`1.cpp`，但`dev`分支未删除。
		- 切换分支后,工作目录会自动更新为对应分支的文件状态。
			- `git switch dev` ,`1.cpp`仍存在。
			- `ls`查看文件列表，通过`git status`查看分支状态。

### 2.3 git flow

#### 2.3.1 merge/pr

```Bash
# 1. 克隆并创建分支
git clone xxx.git
git switch -c feature/new-feature #feature/new-feature 是一个完整的分支名

# 2. 开发并多次提交
git add . && git commit -m "功能开发"
git add . && git commit -m "修复测试反馈"
git add . && git commit -m "优化性能"

# 3. 同步远程 main 并压缩提交
git fetch origin
git rebase -i origin/main  # 压缩提交

# 4. 解决冲突（如有）
git rebase --continue

# 5.(二选一)
# 5.1 推送到远程
git push origin feature/new-feature
# 5.2 直接本地merge
git switch main
git merge feature/new-feature
git push origin main

# 6. 创建 PR 并选择 "Squash and Merge"（可选）
# 7. 删除分支
git branch -d feature/new-feature
git push origin --delete feature/new-feature
```

#### 2.3.2 worktree

```Bash
# 不同于clone多个文件夹，git worktree共享同一个.git文件，
# 即分支共享，减少了文件大小

git clone xxx.git
git worktree add ../mydev origin dev #创建dev分支的本地分支在../mydev

# 所有的git branch 操作，c d 增删，都可以在这两个文件夹内观测到
# 正常的提交是一样的，log和暂存区独立
cd mydev # 在独立的文件夹开发，独立暂存区，但branch共享
cd main # 在独立的文件夹开发，独立暂存区，但branch共享

# 用后删除
# 方法1：使用 git worktree remove（Git 2.15+）
git worktree remove ../mydev  # 自动清理目录并更新引用,不可以在mydev内使用

# 方法2：手动删除（你的方式）
cd .. && rm -rf mydev         # 删除工作树目录
cd main-repo && git worktree prune  # 清理失效的工作树引用
```